(()=>{"use strict";var t;!function(t){t.DEFAULT="default",t.CORRECT="correct",t.INCORRECT="incorrect"}(t||(t={}));class e{constructor(t){this.gameActive=!1,this.audioContext=null,this.currentAudio=null,this.config=t,this.gameContainer=document.getElementById("game-container"),this.hugeTextElement=document.getElementById("huge-text"),this.speakerButton=document.getElementById("speaker-button");const e=document.querySelectorAll(".cell");this.cells=Array.from(e),this.initializeUI()}initializeUI(){this.speakerButton.addEventListener("click",()=>{this.gameActive&&this.playTargetSound()}),this.cells.forEach((t,e)=>{t.addEventListener("click",()=>{this.gameActive&&this.handleCellClick(e)})}),this.startGame()}startGame(){this.setupGame(),setTimeout(()=>{this.playInstructionSound()},500)}setupGame(){this.cells.forEach(e=>{e.innerHTML="",this.setCellState(e,t.DEFAULT)}),this.populateCells();const e=this.getHugeTextContent();e?(this.hugeTextElement.style.display="block",this.hugeTextElement.textContent=e):this.hugeTextElement.style.display="none",this.gameActive=!0}handleCellClick(e){this.gameActive=!1,this.isCorrect(e)?(this.setCellState(this.cells[e],t.CORRECT),this.playFeedbackSound(!0),setTimeout(()=>{window.Android&&window.Android.onGameCompleted()},2e3)):(this.setCellState(this.cells[e],t.INCORRECT),this.cells.forEach((e,i)=>{this.isCorrect(i)&&this.setCellState(e,t.CORRECT)}),this.playFeedbackSound(!1),setTimeout(()=>{this.setupGame(),this.playTargetSound()},3e3))}setCellState(t,e){t.classList.remove("cell-default","cell-correct","cell-incorrect"),t.classList.add(`cell-${e}`)}playAudio(t,e){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.currentAudio=new Audio(t),this.currentAudio.volume=1,this.currentAudio.addEventListener("ended",()=>{this.currentAudio=null,e&&e()}),this.currentAudio.addEventListener("error",t=>{console.error("Audio playback error:",t),this.currentAudio=null,e&&e()}),this.currentAudio.play().catch(t=>{console.error("Failed to play audio:",t)})}playInstructionSound(){const t=this.getAudioFiles();this.playAudio(t.instruction,()=>{setTimeout(()=>{this.gameActive&&this.playTargetSound()},50)})}playTargetSound(){const t=this.getAudioFiles();this.playAudio(t.target)}playFeedbackSound(t){const e=this.getAudioFiles(),i=t?e.wellDone:e.tryAgain;this.playAudio(i)}reset(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.setupGame()}destroy(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.gameActive=!1}}class i extends e{constructor(t){super(t),this.targetNumber=0,this.correctCellIndex=0}populateCells(){this.targetNumber=Math.floor(11*Math.random()),this.correctCellIndex=Math.floor(6*Math.random()),this.generateCounts().forEach((t,e)=>{const i=this.createNumberElement(t);this.cells[e].appendChild(i)})}generateCounts(){const t=[],e=new Set;for(let i=0;i<6;i++)if(i===this.correctCellIndex)t.push(this.targetNumber),e.add(this.targetNumber);else{let i;do{i=Math.floor(11*Math.random())}while(e.has(i));t.push(i),e.add(i)}return t}createNumberElement(t){const e=document.createElement("div");e.className="number-text",e.textContent=t.toString();const s=Math.floor(Math.random()*i.COLOR_PALETTE.length);return e.style.color=i.COLOR_PALETTE[s],e}isCorrect(t){return t===this.correctCellIndex}getAudioFiles(){return{instruction:"numbers/audio/instructions_numbers_mode.ogg",target:`numbers/audio/${["zero.ogg","one.ogg","two.ogg","three.ogg","four.ogg","five.ogg","six.ogg","seven.ogg","eight.ogg","nine.ogg","ten.ogg"][this.targetNumber]}`,wellDone:"numbers/audio/well_done.ogg",tryAgain:"numbers/audio/try_again.ogg"}}getHugeTextContent(){return null}}i.COLOR_PALETTE=["#FF69B4","#FF4500","#32CD32","#FF1493","#00BFFF","#FFD700","#FF6347","#9370DB","#00CED1","#FFA500"];class s extends e{constructor(t){super(t),this.wordImagePairs=[{word:"Apple",emoji:"ðŸŽ",audioFile:"apple.ogg"},{word:"Cat",emoji:"ðŸ±",audioFile:"cat.ogg"},{word:"Sun",emoji:"â˜€ï¸",audioFile:"sun.ogg"},{word:"Tree",emoji:"ðŸŒ³",audioFile:"tree.ogg"},{word:"Car",emoji:"ðŸš—",audioFile:"car.ogg"},{word:"House",emoji:"ðŸ ",audioFile:"house.ogg"},{word:"Star",emoji:"â­",audioFile:"star.ogg"},{word:"Heart",emoji:"â¤ï¸",audioFile:"heart.ogg"},{word:"Book",emoji:"ðŸ“š",audioFile:"book.ogg"},{word:"Ball",emoji:"âš½",audioFile:"ball.ogg"}],this.selectedPairs=[],this.shuffledEmojis=[],this.matches=new Map,this.isDrawing=!1,this.startWordIndex=-1,this.currentX=0,this.currentY=0,this.wordElements=[],this.emojiElements=[],this.canvas=document.createElement("canvas"),this.canvas.id="match-canvas",this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="10",this.gameContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",()=>this.resizeCanvas())}resizeCanvas(){this.canvas.width=this.gameContainer.offsetWidth,this.canvas.height=this.gameContainer.offsetHeight,this.redrawLines()}populateCells(){this.gameContainer.innerHTML="",this.gameContainer.appendChild(this.canvas);const t=[...this.wordImagePairs].sort(()=>Math.random()-.5);this.selectedPairs=t.slice(0,3),this.shuffledEmojis=[...this.selectedPairs.map(t=>t.emoji)].sort(()=>Math.random()-.5);const e=document.createElement("div");e.className="match-words-layout";const i=document.createElement("div");i.className="words-column",this.wordElements=[],this.selectedPairs.forEach((t,e)=>{const s=this.createWordElement(t.word,e);i.appendChild(s),this.wordElements.push(s)});const s=document.createElement("div");s.className="emojis-column",this.emojiElements=[],this.shuffledEmojis.forEach((t,e)=>{const i=this.createEmojiElement(t,e);s.appendChild(i),this.emojiElements.push(i)}),e.appendChild(i),e.appendChild(s),this.gameContainer.appendChild(e),this.matches.clear(),setTimeout(()=>this.resizeCanvas(),100)}createWordElement(t,e){const i=document.createElement("div");return i.className="word-item",i.textContent=t,i.dataset.index=e.toString(),i.addEventListener("mousedown",t=>this.startDrawing(t,e)),i.addEventListener("touchstart",t=>this.startDrawing(t,e)),i}createEmojiElement(t,e){const i=document.createElement("div");return i.className="emoji-item",i.textContent=t,i.dataset.index=e.toString(),i.addEventListener("mouseup",t=>this.endDrawing(t,e)),i.addEventListener("touchend",t=>this.endDrawing(t,e)),i}startDrawing(t,e){if(!this.gameActive)return;t.preventDefault(),this.isDrawing=!0,this.startWordIndex=e;const i=this.wordElements[e],s=i.getBoundingClientRect(),n=this.gameContainer.getBoundingClientRect();this.currentX=s.right-n.left,this.currentY=s.top+s.height/2-n.top,i.classList.add("drawing");const o=t=>this.updateDrawing(t);document.addEventListener("mousemove",o),document.addEventListener("touchmove",o);const r=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r),this.isDrawing&&this.cancelDrawing()};document.addEventListener("mouseup",r),document.addEventListener("touchend",r)}updateDrawing(t){if(!this.isDrawing)return;const e=this.gameContainer.getBoundingClientRect();if(t instanceof MouseEvent)this.currentX=t.clientX-e.left,this.currentY=t.clientY-e.top;else{const i=t.touches[0];this.currentX=i.clientX-e.left,this.currentY=i.clientY-e.top}this.redrawLines(),this.drawCurrentLine()}endDrawing(t,e){if(!this.isDrawing||-1===this.startWordIndex)return;t.preventDefault(),this.isDrawing=!1,this.wordElements[this.startWordIndex].classList.remove("drawing");const i=this.selectedPairs[this.startWordIndex],s=this.shuffledEmojis[e];i.emoji===s?(this.matches.set(this.startWordIndex,e),this.wordElements[this.startWordIndex].classList.add("matched"),this.emojiElements[e].classList.add("matched"),this.redrawLines(),this.matches.size===this.selectedPairs.length&&(this.gameActive=!1,this.playFeedbackSound(!0),setTimeout(()=>{window.Android&&window.Android.onGameCompleted()},2e3))):(this.emojiElements[e].classList.add("wrong"),setTimeout(()=>{this.emojiElements[e].classList.remove("wrong")},500)),this.startWordIndex=-1}cancelDrawing(){this.isDrawing=!1,-1!==this.startWordIndex&&this.wordElements[this.startWordIndex].classList.remove("drawing"),this.startWordIndex=-1,this.redrawLines()}drawCurrentLine(){if(!this.isDrawing||-1===this.startWordIndex)return;const t=this.wordElements[this.startWordIndex].getBoundingClientRect(),e=this.gameContainer.getBoundingClientRect(),i=t.right-e.left,s=t.top+t.height/2-e.top;this.ctx.strokeStyle="#667eea",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.setLineDash([5,5]),this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(this.currentX,this.currentY),this.ctx.stroke(),this.ctx.setLineDash([])}redrawLines(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const t=this.gameContainer.getBoundingClientRect();this.matches.forEach((e,i)=>{const s=this.wordElements[i],n=this.emojiElements[e],o=s.getBoundingClientRect(),r=n.getBoundingClientRect(),a=o.right-t.left,d=o.top+o.height/2-t.top,h=r.left-t.left,l=r.top+r.height/2-t.top;this.ctx.strokeStyle="#4CAF50",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(a,d),this.ctx.lineTo(h,l),this.ctx.stroke()})}isCorrect(t){return!1}getAudioFiles(){return{instruction:"match-words/audio/instructions_match_words.ogg",target:"match-words/audio/instructions_match_words.ogg",wellDone:"numbers/audio/well_done.ogg",tryAgain:"numbers/audio/try_again.ogg"}}getHugeTextContent(){return null}destroy(){super.destroy(),window.removeEventListener("resize",()=>this.resizeCanvas())}}let n=null;window.initGame=(t,e="numbers")=>{console.log("Initializing game with config:",t,"type:",e),n&&n.destroy(),n="match-words"===e?new s(t):new i(t)},window.resetGame=()=>{console.log("Resetting game"),n&&n.reset()},window.addEventListener("DOMContentLoaded",()=>{console.log("Game page loaded and ready")})})();