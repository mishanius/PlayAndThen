(()=>{"use strict";var t;!function(t){t.DEFAULT="default",t.CORRECT="correct",t.INCORRECT="incorrect"}(t||(t={}));class e{constructor(t){this.gameActive=!1,this.introPlayed=!1,this.currentEquation=null,this.correctOptionIndex=0,this.optionCells=[],this.currentAudio=null,this.config=t,this.gameContainer=document.getElementById("game-container"),this.characterContainer=document.getElementById("character-container"),this.leftImage=document.getElementById("left-image"),this.rightImage=document.getElementById("right-image"),this.resultImage=document.getElementById("result-image"),this.optionCells=Array.from(document.querySelectorAll(".option-cell")),this.initializeUI()}initializeUI(){this.characterContainer.addEventListener("click",()=>{this.playInstructionSound(),this.introPlayed=!0}),this.optionCells.forEach((t,e)=>{t.addEventListener("click",()=>{this.gameActive&&this.handleOptionClick(e)})}),this.startGame()}startGame(){this.setupGame(),void 0!==window.Android&&(setTimeout(()=>this.playInstructionSound(),500),this.introPlayed=!0)}setupGame(){this.optionCells.forEach(e=>this.setCellState(e,t.DEFAULT)),this.resultImage.style.opacity="0.3",this.resultImage.src="",this.populateEquation(),this.gameActive=!0}populateEquation(){this.currentEquation=e.EQUATIONS[Math.floor(Math.random()*e.EQUATIONS.length)],this.leftImage.src=this.getImagePath(this.currentEquation.left),this.rightImage.src=this.getImagePath(this.currentEquation.right);const t=e.EQUATIONS.map(t=>t.result).filter(t=>t!==this.currentEquation.result).sort(()=>Math.random()-.5).slice(0,2),i=[this.currentEquation.result,...t].sort(()=>Math.random()-.5);this.correctOptionIndex=i.indexOf(this.currentEquation.result),i.forEach((t,e)=>{this.optionCells[e].querySelector("img").src=this.getImagePath(t)})}getImagePath(t){return void 0!==window.Android&&navigator.userAgent.includes("Android")?`file:///android_asset/games/logic-add/images/${t}.png`:`./images/${t}.png`}handleOptionClick(e){this.gameActive=!1,e===this.correctOptionIndex?(this.setCellState(this.optionCells[e],t.CORRECT),this.resultImage.src=this.getImagePath(this.currentEquation.result),this.resultImage.style.opacity="1",this.playFeedbackSound(!0),setTimeout(()=>{window.Android&&window.Android.onGameCompleted()},2e3)):(this.setCellState(this.optionCells[e],t.INCORRECT),this.setCellState(this.optionCells[this.correctOptionIndex],t.CORRECT),this.playFeedbackSound(!1),setTimeout(()=>this.setupGame(),3e3))}setCellState(t,e){t.classList.remove("cell-default","cell-correct","cell-incorrect"),t.classList.add(`cell-${e}`)}playAudio(t,e){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.currentAudio=new Audio(t),this.currentAudio.volume=1,this.currentAudio.addEventListener("ended",()=>{this.currentAudio=null,e?.()}),this.currentAudio.addEventListener("error",()=>{this.currentAudio=null,e?.()}),this.currentAudio.play().catch(console.error)}playInstructionSound(){this.playAudio(this.getAudioFiles().instruction)}playFeedbackSound(t){const e=this.getAudioFiles();this.playAudio(t?e.wellDone:e.tryAgain)}getAudioFiles(){const t=void 0!==window.Android&&navigator.userAgent.includes("Android")?"file:///android_asset/games/audio":"../audio";return{instruction:`${t}/instructions_logic_add.ogg`,wellDone:`${t}/well_done.ogg`,tryAgain:`${t}/try_again.ogg`}}reset(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.setupGame()}destroy(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.gameActive=!1}}e.EQUATIONS=[{left:"seed",right:"water",result:"tree"},{left:"bread",right:"cheese",result:"sandwich"},{left:"wool",right:"needles",result:"sweater"},{left:"wood",right:"hammer",result:"chair"},{left:"cow",right:"grass",result:"milk"},{left:"bee",right:"flower",result:"honey"},{left:"flour",right:"oven",result:"bread"},{left:"paint",right:"brush",result:"picture"},{left:"egg",right:"pan",result:"omelette"},{left:"thread",right:"needle",result:"button"},{left:"apple",right:"knife",result:"slices"},{left:"lemon",right:"water",result:"lemonade"},{left:"tomato",right:"pot",result:"soup"},{left:"clay",right:"hands",result:"vase"}],document.addEventListener("DOMContentLoaded",()=>{window.game=new e({containerId:"game-container"})})})();