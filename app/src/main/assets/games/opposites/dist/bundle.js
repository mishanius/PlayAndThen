(()=>{"use strict";var t={956(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.OppositesGame=void 0,e.OppositesGame=class{constructor(t){this.gameActive=!1,this.introPlayed=!1,this.opposites=[{left:"happy.png",right:"sad.png"},{left:"big.png",right:"small.png"},{left:"hot.png",right:"cold.png"},{left:"fast.png",right:"slow.png"},{left:"day.png",right:"night.png"},{left:"up.png",right:"down.png"}],this.selectedPairs=[],this.shuffledRight=[],this.matches=new Map,this.isDrawing=!1,this.startIndex=-1,this.currentX=0,this.currentY=0,this.leftElements=[],this.rightElements=[],this.currentAudio=null,this.config=t,this.gameContainer=document.getElementById("game-container"),this.characterContainer=document.getElementById("character-container"),this.canvas=document.createElement("canvas"),this.canvas.id="match-canvas",this.canvas.style.cssText="position:absolute;top:0;left:0;pointer-events:none;z-index:10",this.gameContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.characterContainer.addEventListener("click",()=>{this.introPlayed||(this.introPlayed=!0,this.playInstructionSound())}),window.addEventListener("resize",()=>this.resizeCanvas()),this.startGame()}resizeCanvas(){this.canvas.width=this.gameContainer.offsetWidth,this.canvas.height=this.gameContainer.offsetHeight,this.redrawLines()}startGame(){this.setupGame(),void 0!==window.Android&&(setTimeout(()=>this.playInstructionSound(),500),this.introPlayed=!0)}setupGame(){const t=this.gameContainer.querySelector(".opposites-layout");t&&t.remove(),this.selectedPairs=[...this.opposites].sort(()=>Math.random()-.5).slice(0,3),this.shuffledRight=[...this.selectedPairs.map(t=>t.right)].sort(()=>Math.random()-.5);const e=document.createElement("div");e.className="opposites-layout";const i=document.createElement("div");i.className="left-column",this.leftElements=[],this.selectedPairs.forEach((t,e)=>{const s=this.createImageElement(t.left,e,!0);i.appendChild(s),this.leftElements.push(s)});const s=document.createElement("div");s.className="right-column",this.rightElements=[],this.shuffledRight.forEach((t,e)=>{const i=this.createImageElement(t,e,!1);s.appendChild(i),this.rightElements.push(i)}),e.appendChild(i),e.appendChild(s),this.gameContainer.appendChild(e),this.matches.clear(),this.gameActive=!0,setTimeout(()=>this.resizeCanvas(),100)}createImageElement(t,e,i){const s=document.createElement("div");s.className="image-item "+(i?"left-item":"right-item");const n=document.createElement("img");return n.src=this.getImagePath(t),n.alt=t,n.draggable=!1,s.appendChild(n),s.dataset.index=e.toString(),i&&(s.addEventListener("mousedown",t=>this.startDrawing(t,e)),s.addEventListener("touchstart",t=>this.startDrawing(t,e))),s}getImagePath(t){return void 0!==window.Android&&navigator.userAgent.includes("Android")?`file:///android_asset/games/opposites/images/${t}`:window.location.pathname.includes("/dist/")?`../images/${t}`:`./images/${t}`}startDrawing(t,e){if(!this.gameActive)return;t.preventDefault(),this.isDrawing=!0,this.startIndex=e;const i=this.leftElements[e].getBoundingClientRect(),s=this.gameContainer.getBoundingClientRect();this.currentX=i.right-s.left,this.currentY=i.top+i.height/2-s.top,this.leftElements[e].classList.add("drawing");const n=t=>this.updateDrawing(t),r=t=>{document.removeEventListener("mousemove",n),document.removeEventListener("touchmove",n),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r),this.handleDrop(t)};document.addEventListener("mousemove",n),document.addEventListener("touchmove",n),document.addEventListener("mouseup",r),document.addEventListener("touchend",r)}handleDrop(t){if(!this.isDrawing||-1===this.startIndex)return;let e,i;if(t instanceof MouseEvent)e=t.clientX,i=t.clientY;else{const s=t.changedTouches[0];e=s.clientX,i=s.clientY}let s=-1;this.rightElements.forEach((t,n)=>{const r=t.getBoundingClientRect();e>=r.left&&e<=r.right&&i>=r.top&&i<=r.bottom&&(s=n)}),this.isDrawing=!1,this.leftElements[this.startIndex].classList.remove("drawing"),-1!==s&&(this.selectedPairs[this.startIndex].right===this.shuffledRight[s]?(this.matches.set(this.startIndex,s),this.leftElements[this.startIndex].classList.add("matched"),this.rightElements[s].classList.add("matched"),this.redrawLines(),this.matches.size===this.selectedPairs.length&&(this.gameActive=!1,this.playFeedbackSound(!0),setTimeout(()=>{window.Android&&window.Android.onGameCompleted()},2e3))):(this.rightElements[s].classList.add("wrong"),setTimeout(()=>this.rightElements[s].classList.remove("wrong"),500))),this.startIndex=-1,this.redrawLines()}updateDrawing(t){if(!this.isDrawing)return;const e=this.gameContainer.getBoundingClientRect();t instanceof MouseEvent?(this.currentX=t.clientX-e.left,this.currentY=t.clientY-e.top):(this.currentX=t.touches[0].clientX-e.left,this.currentY=t.touches[0].clientY-e.top),this.redrawLines(),this.drawCurrentLine()}drawCurrentLine(){if(!this.isDrawing||-1===this.startIndex)return;const t=this.leftElements[this.startIndex].getBoundingClientRect(),e=this.gameContainer.getBoundingClientRect(),i=t.right-e.left,s=t.top+t.height/2-e.top;this.ctx.strokeStyle="#667eea",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.setLineDash([5,5]),this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(this.currentX,this.currentY),this.ctx.stroke(),this.ctx.setLineDash([])}redrawLines(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const t=this.gameContainer.getBoundingClientRect();this.matches.forEach((e,i)=>{const s=this.leftElements[i].getBoundingClientRect(),n=this.rightElements[e].getBoundingClientRect();this.ctx.strokeStyle="#4CAF50",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(s.right-t.left,s.top+s.height/2-t.top),this.ctx.lineTo(n.left-t.left,n.top+n.height/2-t.top),this.ctx.stroke()})}playAudio(t,e){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.currentAudio=new Audio(t),this.currentAudio.volume=1,this.currentAudio.addEventListener("ended",()=>{this.currentAudio=null,e&&e()}),this.currentAudio.addEventListener("error",()=>{this.currentAudio=null,e&&e()}),this.currentAudio.play().catch(console.error)}playInstructionSound(){this.playAudio(this.getAudioFiles().instruction)}playFeedbackSound(t){const e=this.getAudioFiles();this.playAudio(t?e.wellDone:e.tryAgain)}getAudioFiles(){const t=void 0!==window.Android&&navigator.userAgent.includes("Android")?"file:///android_asset/games/audio":"../../audio";return{instruction:`${t}/instructions_opposites.ogg`,target:`${t}/instructions_opposites.ogg`,wellDone:`${t}/well_done.ogg`,tryAgain:`${t}/try_again.ogg`}}reset(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.setupGame()}destroy(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.gameActive=!1}}}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,i),r.exports}(()=>{const t=i(956);document.addEventListener("DOMContentLoaded",()=>{window.game=new t.OppositesGame({containerId:"game-container"})})})()})();