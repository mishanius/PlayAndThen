(()=>{"use strict";var t={842(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MatchWordsGame=void 0,e.MatchWordsGame=class{constructor(t){this.gameActive=!1,this.introPlayed=!1,this.associations=[{left:"dog.png",right:"doghouse.png"},{left:"fish.png",right:"fishbowl.png"},{left:"bird.png",right:"nest.png"},{left:"bee.png",right:"beehive.png"},{left:"squirrel.png",right:"tree.png"},{left:"cow.png",right:"barn.png"},{left:"bear.png",right:"cave.png"},{left:"mouse.png",right:"mousehole.png"},{left:"rabbit.png",right:"burrow.png"},{left:"spider.png",right:"web.png"}],this.selectedPairs=[],this.shuffledRight=[],this.matches=new Map,this.isDrawing=!1,this.startWordIndex=-1,this.currentX=0,this.currentY=0,this.wordElements=[],this.emojiElements=[],this.currentAudio=null,this.config=t,this.gameContainer=document.getElementById("game-container"),this.characterContainer=document.getElementById("character-container"),this.canvas=document.createElement("canvas"),this.canvas.id="match-canvas",this.canvas.style.cssText="position:absolute;top:0;left:0;pointer-events:none;z-index:10",this.gameContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.characterContainer.addEventListener("click",()=>{this.introPlayed||(this.introPlayed=!0,this.playInstructionSound())}),window.addEventListener("resize",()=>this.resizeCanvas()),this.startGame()}resizeCanvas(){this.canvas.width=this.gameContainer.offsetWidth,this.canvas.height=this.gameContainer.offsetHeight,this.redrawLines()}startGame(){this.setupGame(),void 0!==window.Android&&(setTimeout(()=>this.playInstructionSound(),500),this.introPlayed=!0)}setupGame(){const t=this.gameContainer.querySelector(".match-words-layout");t&&t.remove(),this.selectedPairs=[...this.associations].sort(()=>Math.random()-.5).slice(0,3),this.shuffledRight=[...this.selectedPairs.map(t=>t.right)].sort(()=>Math.random()-.5);const e=document.createElement("div");e.className="match-words-layout";const i=document.createElement("div");i.className="words-column",this.wordElements=[],this.selectedPairs.forEach((t,e)=>{const s=this.createLeftElement(t.left,e);i.appendChild(s),this.wordElements.push(s)});const s=document.createElement("div");s.className="emojis-column",this.emojiElements=[],this.shuffledRight.forEach((t,e)=>{const i=this.createRightElement(t,e);s.appendChild(i),this.emojiElements.push(i)}),e.appendChild(i),e.appendChild(s),this.gameContainer.appendChild(e),this.matches.clear(),this.gameActive=!0,setTimeout(()=>this.resizeCanvas(),100)}createLeftElement(t,e){const i=document.createElement("div");i.className="emoji-item left-item";const s=document.createElement("img");return s.src=this.getImagePath(t),s.alt=t,s.draggable=!1,i.appendChild(s),i.dataset.index=e.toString(),i.addEventListener("mousedown",t=>this.startDrawing(t,e)),i.addEventListener("touchstart",t=>this.startDrawing(t,e)),i}createRightElement(t,e){const i=document.createElement("div");i.className="emoji-item right-item";const s=document.createElement("img");return s.src=this.getImagePath(t),s.alt=t,s.draggable=!1,i.appendChild(s),i.dataset.index=e.toString(),i}getImagePath(t){return void 0!==window.Android&&navigator.userAgent.includes("Android")?`file:///android_asset/games/match-words/images/${t}`:`../images/${t}`}startDrawing(t,e){if(!this.gameActive)return;t.preventDefault(),this.isDrawing=!0,this.startWordIndex=e;const i=this.wordElements[e].getBoundingClientRect(),s=this.gameContainer.getBoundingClientRect();this.currentX=i.right-s.left,this.currentY=i.top+i.height/2-s.top,this.wordElements[e].classList.add("drawing");const n=t=>this.updateDrawing(t),r=t=>{document.removeEventListener("mousemove",n),document.removeEventListener("touchmove",n),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r),this.handleDrop(t)};document.addEventListener("mousemove",n),document.addEventListener("touchmove",n),document.addEventListener("mouseup",r),document.addEventListener("touchend",r)}handleDrop(t){if(!this.isDrawing||-1===this.startWordIndex)return;let e,i;if(t instanceof MouseEvent)e=t.clientX,i=t.clientY;else{const s=t.changedTouches[0];e=s.clientX,i=s.clientY}let s=-1;this.emojiElements.forEach((t,n)=>{const r=t.getBoundingClientRect();e>=r.left&&e<=r.right&&i>=r.top&&i<=r.bottom&&(s=n)}),this.isDrawing=!1,this.wordElements[this.startWordIndex].classList.remove("drawing"),-1!==s&&(this.selectedPairs[this.startWordIndex].right===this.shuffledRight[s]?(this.matches.set(this.startWordIndex,s),this.wordElements[this.startWordIndex].classList.add("matched"),this.emojiElements[s].classList.add("matched"),this.redrawLines(),this.matches.size===this.selectedPairs.length&&(this.gameActive=!1,this.playFeedbackSound(!0),setTimeout(()=>{window.Android&&window.Android.onGameCompleted()},2e3))):(this.emojiElements[s].classList.add("wrong"),setTimeout(()=>this.emojiElements[s].classList.remove("wrong"),500))),this.startWordIndex=-1,this.redrawLines()}updateDrawing(t){if(!this.isDrawing)return;const e=this.gameContainer.getBoundingClientRect();t instanceof MouseEvent?(this.currentX=t.clientX-e.left,this.currentY=t.clientY-e.top):(this.currentX=t.touches[0].clientX-e.left,this.currentY=t.touches[0].clientY-e.top),this.redrawLines(),this.drawCurrentLine()}drawCurrentLine(){if(!this.isDrawing||-1===this.startWordIndex)return;const t=this.wordElements[this.startWordIndex].getBoundingClientRect(),e=this.gameContainer.getBoundingClientRect(),i=t.right-e.left,s=t.top+t.height/2-e.top;this.ctx.strokeStyle="#667eea",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.setLineDash([5,5]),this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(this.currentX,this.currentY),this.ctx.stroke(),this.ctx.setLineDash([])}redrawLines(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const t=this.gameContainer.getBoundingClientRect();this.matches.forEach((e,i)=>{const s=this.wordElements[i].getBoundingClientRect(),n=this.emojiElements[e].getBoundingClientRect();this.ctx.strokeStyle="#4CAF50",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(s.right-t.left,s.top+s.height/2-t.top),this.ctx.lineTo(n.left-t.left,n.top+n.height/2-t.top),this.ctx.stroke()})}playAudio(t,e){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.currentAudio=new Audio(t),this.currentAudio.volume=1,this.currentAudio.addEventListener("ended",()=>{this.currentAudio=null,e&&e()}),this.currentAudio.addEventListener("error",()=>{this.currentAudio=null,e&&e()}),this.currentAudio.play().catch(console.error)}playInstructionSound(){this.playAudio(this.getAudioFiles().instruction)}playFeedbackSound(t){const e=this.getAudioFiles();this.playAudio(t?e.wellDone:e.tryAgain)}getAudioFiles(){const t=void 0!==window.Android&&navigator.userAgent.includes("Android")?"file:///android_asset/games/audio":"../../audio";return{instruction:`${t}/instructions_match_words.ogg`,target:`${t}/instructions_match_words.ogg`,wellDone:`${t}/well_done.ogg`,tryAgain:`${t}/try_again.ogg`}}reset(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.setupGame()}destroy(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),this.gameActive=!1}}}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,i),r.exports}(()=>{const t=i(842);let e=null;window.initGame=i=>{console.log("Initializing Match Words game with config:",i),e&&e.destroy(),e=new t.MatchWordsGame(i)},window.resetGame=()=>{console.log("Resetting Match Words game"),e&&e.reset()},window.addEventListener("DOMContentLoaded",()=>{console.log("Match Words game page loaded and ready")})})()})();